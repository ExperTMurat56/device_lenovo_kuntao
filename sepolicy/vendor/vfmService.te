type vfmService, domain, binder_in_vendor_violators;
type vfmService_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(vfmService)
binder_use(vfmService)


allow vfmService { persist_drm_file fingerprintd_data_file }:dir create_dir_perms;
allow vfmService { persist_drm_file fingerprintd_data_file }:file create_file_perms;

#Allow access to goodix device
allow vfmService vfsspi_device:chr_file rw_file_perms;

#Allow access to tee device
allow vfmService tee_device:chr_file rw_file_perms;

# Allow access to ion device
allow vfmService ion_device:chr_file rw_file_perms;

#allow create socket
allow vfmService self:socket create_socket_perms_no_ioctl;
allow vfmService self:{ netlink_socket netlink_generic_socket } create_socket_perms_no_ioctl;

#allow read/write property
set_prop(vfmService, system_prop)

allow vfmService vfsspi_service:service_manager { add find };

allow vfmService hal_fingerprint_mido:binder { transfer call };
allow vfmService fuse:dir search;
allow vfmService fuse:file { getattr open append };
allow vfmService storage_file:dir search;
allow vfmService storage_file:lnk_file read;
allow vfmService mnt_user_file:dir search;
r_dir_file(vfmService, firmware_file)

#register service in service manager
allow vfmService default_android_service:service_manager find;

add_service(vfmService, vfsspi_service);
